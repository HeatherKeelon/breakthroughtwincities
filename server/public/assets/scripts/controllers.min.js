/*! breakthrough 2015-12-18 */
myApp.controller("absentCtrl",["$scope","$http","DataService",function(a,b,c){console.log("on admin absent controller--absentCtrl.js"),a.dataService=c,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)});var d='<div ng-if="row.entity.contact_status">{{row.entity.contact_status}}</div><div ng-if="!row.entity.contact_status">Not Yet Called</div>',e='<input type="checkbox" name="excused" value="Yes">Yes',f='<input type="checkbox" name="homework_sent" value="Yes">Yes';a.gridOptions={enableSorting:!0,columnDefs:[{name:"id",field:"id",enableCellEdit:!1},{name:"Teacher",field:"lastname",enableCellEdit:!0},{name:"First Name",field:"student_firstname",enableCellEdit:!0},{name:"Last Name",field:"student_lastname",enableCellEdit:!0},{name:"Phone 1",field:"phone1",enableCellEdit:!0},{name:"Call Status",field:"contact_status",cellTemplate:d,enableCellEdit:!0,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownValueLabel:"contact_status",editDropdownOptionsArray:[{id:"Not Yet Called",contact_status:"Not Yet Called"},{id:"Reached",contact_status:"Reached"},{id:"Left Message",contact_status:"Left Message"}]},{name:"Homework Sent",field:"homework_sent",cellTemplate:f,enableCellEdit:!0},{name:"Excused",field:"excused",cellTemplate:e,enableCellEdit:!0},{name:"Attendance Notes",field:"attendance_notes",enableCellEdit:!0}]},console.log(a.dataService.getData()),a.gridOptions.data=a.dataService.getData(),a.saveRow=function(c){var d=b.put("/updateStudent/inline",c).then(function(a){console.log(a)});a.gridApi.rowEdit.setSavePromise(c,d)},a.gridOptions.onRegisterApi=function(b){a.gridApi=b,b.rowEdit.on.saveRow(a,a.saveRow)},a.openStudent=function(c){b.get("/student",{params:{who:c}}).then(function(b){console.log(b.data),a.dataService.setData(b.data)})}}]),myApp.controller("attendanceCtrl",["$scope","$http","$location","DataService",function(a,b,c,d){console.log("on admin attendance controller--attendanceCtrl.js")}]),myApp.controller("dashCtrl",["$scope","$http","$location","DataService",function(a,b,c,d){a.dataService=d,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.prework={},a.absent={},a.getAbsences=function(){b.get("/absent",{params:{date:a.absent.date}}).then(function(b){a.dataService.setData(b.data),c.path("/absent")})},a.getPrework=function(){b.get("/prework",{params:{date:a.prework.date}}).then(function(b){a.dataService.setData(b.data),c.path("/prework")})},console.log("on admin dashboard controller--dashCtrl.js")}]),myApp.controller("preworkCtrl",["$scope","$http","$location","DataService",function(a,b,c,d){console.log("on admin prework controller--preworkCtrl.js"),a.dataService=d,a.user={},a.date=a.dataService.getDate(),console.log("This is the date you are asking for",a.date),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)});var e='<div ng-if="row.entity.contact_status">{{row.entity.contact_status}}</div><div ng-if="!row.entity.contact_status">Not Yet Called</div>',f='<div class="ui-grid-cell-contents" ng-click="grid.appScope.getDetails(row.entity)">{{row.entity.id}}</div>';a.gridOptions={enableSorting:!0,columnDefs:[{name:"id",field:"id",enableCellEdit:!1,cellTemplate:f},{name:"Teacher",field:"lastname",enableCellEdit:!1},{name:"First Name",field:"student_firstname",enableCellEdit:!1},{name:"Last Name",field:"student_lastname",enableCellEdit:!1},{name:"Phone 1",field:"phone1",enableCellEdit:!0},{name:"Call Status",field:"contact_status",cellTemplate:e,enableCellEdit:!0,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownValueLabel:"contact_status",editDropdownOptionsArray:[{id:"Not Yet Called",contact_status:"Not Yet Called"},{id:"Reached",contact_status:"Reached"},{id:"Left Message",contact_status:"Left Message"}]},{name:"Administration Notes",field:"admin_notes",enableCellEdit:!0}]},a.gridOptions.data=a.dataService.getData(),a.saveRow=function(c){var d=b.put("/adminPrework",c).then(function(a){console.log(a)});a.gridApi.rowEdit.setSavePromise(c,d)},a.gridOptions.onRegisterApi=function(b){a.gridApi=b,b.rowEdit.on.saveRow(a,a.saveRow)},a.getDetails=function(a){}}]),myApp.controller("teacherCtrl",["$scope","$http","$location","DataService",function(a,b,c,d){console.log("on admin teacher select controller--teacherCtrl.js"),a.dataService=d,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.teachers=[],a.getTeachers=function(){b.get("/admin_attendance",{params:{date:a.date}}).then(function(b){a.teachers=b.data,console.log(a.teachers)})},a.selectTeacher=function(c){b.get("/prework",{params:{date:a.date,who:c}}).then(function(a){console.log(a)})},a.getTeachers()}]),myApp.controller("uploadCtrl",["$scope","$http","Upload","DataService",function(a,b,c,d){console.log("on admin upload controller--uploadCtrl.js"),a.dataService=d,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.uploadStatus=!1,a.upload=function(a){console.log(a),c.upload({url:"/upload",data:{file:a}}).then(function(a){console.log("Success "+a.config.data.file.name+"uploaded. Response: "+a.data)},function(a){console.log("Error status: "+a.status)},function(a){var b=parseInt(100*a.loaded/a.total);console.log("progress: "+b+"% "+a.config.data.file.name)})}}]),myApp.controller("userCtrl",["$scope","$http","$location","DataService",function(a,b,c,d){console.log("on admin user controller--userCtrl.js"),a.dataService=d,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.userList=[],a.newUser={},a.gridOptions={enableSorting:!0,enableColumnResizing:!0,columnDefs:[{name:"First Name",field:"firstname",width:"20%",enableCellEdit:!0},{name:"Last Name",field:"lastname",width:"20%",enableCellEdit:!0},{name:"role",field:"role",minWidth:80,width:90,enableColumnResizing:!1,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownValueLabel:"role",editDropdownOptionsArray:[{id:"admin",role:"Admin"},{id:"teacher",role:"Teacher"}]},{name:"Email",field:"email",minWidth:200,maxWidth:350,enableCellEdit:!0},{name:"",field:"DeleteUser",width:"10%",enableSorting:!1,enableHiding:!1,enableColumnResizing:!1,cellTemplate:'<button style="margin-left: 40%; " class="delete-button" ng-click="grid.appScope.deleteUser(person)">Delete</button>'}]},a.saveRow=function(c){var d=b.put("/roles",c).then(function(a){console.log(a)});a.gridApi.rowEdit.setSavePromise(c,d)},a.gridOptions.onRegisterApi=function(b){a.gridApi=b,b.rowEdit.on.saveRow(a,a.saveRow)},a.submitForm=function(){b.post("/roles",a.newUser).then(function(b){console.log("post response :",b),a.getUserList(),a.newUser={}})},a.getUserList=function(){b.get("/roles").then(function(b){a.gridOptions.data=b.data,console.log("this is userList :",a.userList)})},a.updateUser=function(c){b.put("/roles",c).then(function(b){console.log("put response :",b),a.getUserList()})},a.deleteUser=function(c){b["delete"]("/roles",{params:{deleteMe:c}}).then(function(b){console.log("delete response :",b),a.getUserList()})},a.getUserList()}]),myApp.controller("attendanceTCtrl",["$scope","$http","DataService",function(a,b,c){console.log("on teacher attendance controller--attendanceTCtrl.js"),a.dataService=c,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)})}]),myApp.controller("classCtrl",["$scope","$http","DataService","$location",function(a,b,c,d){console.log("on teacher class controller--classCtrl.js"),a.dataService=c,a.user={},a.date=a.dataService.getDate(),a.students=a.dataService.getData(),a.classdate=a.students[0].class_date.slice(0,10),a.student,console.log("This is your student data",a.students),a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)});var e='<div ng-if="row.entity.contact_status">{{row.entity.contact_status}}</div><div ng-if="!row.entity.contact_status">Not Yet Called</div>',f='<div class="ui-grid-cell-contents" ng-click="grid.appScope.selectStudent(row.entity.id)">{{row.entity.id}}</div>';a.gridOptions={enableSorting:!0,columnDefs:[{name:"id",field:"id",enableCellEdit:!1,cellTemplate:f},{name:"First Name",field:"student_firstname",enableCellEdit:!1},{name:"Last Name",field:"student_lastname",enableCellEdit:!1},{name:"Phone 1",field:"phone1",enableCellEdit:!0},{name:"Call Status",field:"contact_status",cellTemplate:e,enableCellEdit:!0,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownValueLabel:"contact_status",editDropdownOptionsArray:[{id:"Not Yet Called",contact_status:"Not Yet Called"},{id:"Reached",contact_status:"Reached"},{id:"Left Message",contact_status:"Left Message"}]},{name:"Administration Notes",field:"admin_notes",enableCellEdit:!0}]},a.gridOptions.data=a.dataService.getData(),a.saveRow=function(c){var d=b.put("/adminPrework",c).then(function(a){console.log(a)});a.gridApi.rowEdit.setSavePromise(c,d)},a.gridOptions.onRegisterApi=function(b){a.gridApi=b,b.rowEdit.on.saveRow(a,a.saveRow)},a.selectStudent=function(c){b.get("/student",{params:{student:c}}).then(function(b){a.dataService.setStudent(b.data[0]),a.dataService.getStudent(),console.log("This is response.data",b.data[0]),console.log("This is the student in the factory",a.dataService.getStudent()),a.student=a.dataService.getStudent(),a.student.grade<9?d.path("/middleschool"):d.path("/highschool")})}}]),myApp.controller("dashTCtrl",["$scope","$http","DataService","$location",function(a,b,c,d){console.log("on teacher dash controller--dashTCtrl.js"),a.dataService=c,a.user={},a.date=a.dataService.getDate(),a.classes=[],a.user=a.dataService.peopleData(),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.getClasses=function(){b.get("/teacher").then(function(b){console.log("Get classes function"),console.log("response from server",b.data);for(var c=0;c<b.data.length;c++)a.classes.push(b.data[c].class_date.slice(0,10));console.log("This is classes",a.classes)})},a.getPrework=function(c){console.log("This is date",c),b.get("/teacher_prework",{params:{date:c}}).then(function(b){a.dataService.setData(b.data),console.log("This is getData",a.dataService.getData()),d.path("/class")})},a.getAttendance=function(){b.get("/attendance",{params:{date:a.date,who:a.user}}).then(function(a){console.log(a)})},a.getClasses()}]),myApp.controller("studentCtrl",["$scope","$http","DataService",function(a,b,c){console.log("on student controller--studentCtrl.js"),a.dataService=c,a.user={},a.date=a.dataService.getDate(),a.user=a.dataService.peopleData(),a.student=a.dataService.getStudent(),console.log("This is the student that was selected",a.student),void 0===a.dataService.peopleData()&&a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData(),console.log(a.user)}),a.updateNotes=function(c,d){b.put("/updateStudent",{params:{column:c,value:d,id:a.student.id}}).then(function(){console.log("student data updated")})},a.updateBus=function(c,d){b.put("/updateBus",{params:{column:c,value:d,id:a.student.id}}).then(function(){console.log("student data updated")})},a.updateInfo=function(c,d){b.put("/updateStudentInfo",{params:{column:c,value:d,id:a.student.id}}).then(function(){console.log("student data updated")})}}]);